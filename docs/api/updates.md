# Получение обновлений

---

## Новое сообщение

### Opcode - `128`

#### Пример ответа

```json
{
  "ver": 11,
  "cmd": 0,
  "seq": 3,
  "opcode": 128,
  "payload": {
    "chatId": 0,
    "message": {
      "sender": 11111111,
      "id": "111111111111111111",
      "time": 1755111111111,
      "text": "да",
      "type": "USER",
      "attaches": []
    },
    "ttl": false,
    "prevMessageId": "111111111111111112"
  }
}
```


#### Аргументы ответа

| Аргумент         | Тип  | Описание                                         |
|:-----------------|:------:|:-------------------------------------------------|
| `chatId` | int | Айди чата куда пришло новое сообщение |
| `message.sender` | int | Айди юзера который отправил сообщение |
| `message.id` | str | Айди нового сообщения |
| `message.time` | int | Таймстамп в миллисекундах когда было отправлено сообщение |
| `message.text` | str | Текст нового сообщения |
| `message.type` | str | Тип пользователя от которого пришло сообщение |
| `message.attaches` | array[obj] | Список вложений |
| `ttl` | bool | Метка для авто удаляющегося сообщения |
| `prevMessageId` | int | Айди предыдущего сообщения |

---

## Сообщение изменено

### Opcode - `128`

#### Пример ответа

```json
{
  "ver": 11,
  "cmd": 0,
  "seq": 11,
  "opcode": 128,
  "payload": {
    "chatId": 0,
    "message": {
      "sender": 11111111,
      "updateTime": 1755111111111,
      "id": "111111111111111111",
      "time": 1755111111111,
      "text": "да!",
      "type": "USER",
      "status": "EDITED",
      "attaches": []
    },
    "ttl": false
  }
}
```


#### Аргументы ответа

| Аргумент         | Тип  | Описание                                         |
|:-----------------|:------:|:-------------------------------------------------|
| `chatId` | int | Айди чата куда пришло новое сообщение |
| `message.sender` | int | Айди юзера который отправил сообщение |
| `message.updateTime` | int | Таймстамп в миллисекундах когда сообщение было изменено/удалено |
| `message.id` | str | Айди нового сообщения |
| `message.time` | int | Таймстамп в миллисекундах когда было отправлено сообщение |
| `message.text` | str | Текст нового сообщения |
| `message.type` | str | Тип пользователя от которого пришло сообщение |
| `message.status` | str | Статус сообщения (EDITED, REMOVED)
| `message.attaches` | array[obj] | Список вложений |
| `ttl` | bool | Метка для авто удаляющегося сообщения |
| `prevMessageId` | int | Айди предыдущего сообщения |

---

## Сообщение удалено

### Opcode - `128`

#### Пример ответа

```json
{
  "ver": 11,
  "cmd": 0,
  "seq": 7,
  "opcode": 128,
  "payload": {
    "chatId": 0,
    "message": {
      "sender": 11111111,
      "updateTime": 1755111111111,
      "id": "111111111111111111",
      "time": 1755111111111,
      "text": "да!",
      "type": "USER",
      "status": "REMOVED",
      "attaches": []
    },
    "ttl": false
  }
}
```

#### Аргументы ответа

| Аргумент         | Тип  | Описание                                         |
|:-----------------|:-----:|:-------------------------------------------------|
| `chatId` | int | Айди чата куда пришло новое сообщение |
| `message.sender` | int | Айди юзера который отправил сообщение |
| `message.updateTime` | int | Таймстамп в миллисекундах когда сообщение было изменено/удалено |
| `message.id` | str | Айди нового сообщения |
| `message.time` | int | Таймстамп в миллисекундах когда было отправлено сообщение |
| `message.text` | str | Текст нового сообщения |
| `message.type` | str | Тип пользователя от которого пришло сообщение |
| `message.status` | str | Статус сообщения (EDITED, REMOVED)
| `message.attaches` | array[obj] | Список вложений |
| `ttl` | bool | Метка для авто удаляющегося сообщения |
| `prevMessageId` | int | Айди предыдущего сообщения |
